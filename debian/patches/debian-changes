Description: <short summary of the patch>
 TODO: Put a short summary on the line above and replace this paragraph
 with a longer explanation of this change. Complete the meta-information
 with other relevant fields (see below for details). To make it easier, the
 information below has been extracted from the changelog. Adjust it or drop
 it.
 .
 laptop-mode-tools (1.60-1) unstable; urgency=low
 .
   * [709f521] New Upstream Release
     (Closes: 647564)
     - [8389588] Change Intel HDA Audio's default power save timeout to 2 seconds
     - [cc40bd1] usb autosuspend black-/whitelist arg in quotes.
       Thanks to Simon Que
     - [5a4e08a] add readme-debugging.txt
     - [be147e0] Helper tools to provide suspend/hibernate functionality
     - [49afd31] Kill lm-polling-daemon when init stop is called
     - [68b0ff5] Add pm-helper tool to take care of suspend / hibernate.
     - [c7e3038] Use native hibernation helper tool from LMT
     - [a569b29] Check for block device's existence.
       Thanks to Simon Que (Chromium Project)
     - [ab704b2] Use proper device for iwconfig.
       Thanks to bs.net (Closes: 639388)
   * [8fa914a] Drop some of the Recommends to Suggests.
     Thanks to Clea F. Rees (Closes: #640155)
   * [75c51b3] Drop duplicate changelog
Author: Ritesh Raj Sarraf <rrs@debian.org>
Bug-Debian: http://bugs.debian.org/639388
Bug-Debian: http://bugs.debian.org/640155
Bug-Debian: http://bugs.debian.org/647564

---
The information above should follow the Patch Tagging Guidelines, please
checkout http://dep.debian.net/deps/dep3/ to learn about the format. Here
are templates for supplementary fields that you might want to add:

Origin: <vendor|upstream|other>, <url of original patch>
Bug: <url in upstream bugtracker>
Bug-Debian: http://bugs.debian.org/<bugnumber>
Bug-Ubuntu: https://launchpad.net/bugs/<bugnumber>
Forwarded: <no|not-needed|url proving that it has been forwarded>
Reviewed-By: <name and email of someone who approved the patch>
Last-Update: <YYYY-MM-DD>

--- /dev/null
+++ laptop-mode-tools-1.60/laptop-mode-tools.preinst
@@ -0,0 +1,41 @@
+#!/bin/sh
+# preinst script for laptop-mode-tools
+#
+# see: dh_installdeb(1)
+
+set -e
+
+# Remove a no-longer used conffile
+rm_conffile() {
+    local PKGNAME="$1"
+    local CONFFILE="$2"
+
+    [ -e "$CONFFILE" ] || return 0
+
+    local md5sum="$(md5sum $CONFFILE | sed -e 's/ .*//')"
+    local old_md5sum="$(dpkg-query -W -f='${Conffiles}' $PKGNAME | \
+            sed -n -e "\' $CONFFILE ' { s/ obsolete$//; s/.* //; p }")"
+    if [ "$md5sum" != "$old_md5sum" ]; then
+        echo "Obsolete conffile $CONFFILE has been modified by you."
+        echo "Saving as $CONFFILE.dpkg-bak ..."
+        mv -f "$CONFFILE" "$CONFFILE".dpkg-bak
+    else
+        echo "Removing obsolete conffile $CONFFILE ..."
+        rm -f "$CONFFILE"
+    fi
+}
+
+case "$1" in
+install|upgrade)
+    # ideally this clean-up should have been done at the same time
+    # as we stopped shipping the file, but since we had releases in
+    # between we will compare with the version shipping this clean-up
+    # instead of the first version not shipping the file
+    if dpkg --compare-versions "$2" lt "1.51-2"; then
+        rm_conffile laptop-mode-tools "/etc/pm/sleep.d/99laptop-mode"
+    fi
+esac
+
+#DEBHELPER#
+
+exit 0
--- laptop-mode-tools-1.60.orig/etc/init.d/laptop-mode
+++ laptop-mode-tools-1.60/etc/init.d/laptop-mode
@@ -6,63 +6,54 @@
 #
 # config:  /etc/laptop-mode/laptop-mode.conf
 
+### BEGIN INIT INFO
+# Provides:          laptop-mode
+# Should-Start:      $all
+# Required-Start:    $remote_fs
+# Required-Stop:     $remote_fs
+# Default-Start:     2 3 4 5
+# Default-Stop:      0 1 6
+# Short-Description: Enable laptop-mode-tools power management functions
+# Description:       Enable laptop-mode-tools power management functions
+### END INIT INFO
+
+
 test -f /usr/sbin/laptop_mode || exit 0
 
-if [ -f /lib/lsb/init-functions ] ; then
-  . /lib/lsb/init-functions
-else
-  log_success_msg()
-  {
-    logger -t LAPTOP-MODE -p daemon.info -- $*
-    echo "$*"
-  }
-  log_failure_msg()
-  {
-    logger -t LAPTOP-MODE -p daemon.notice -- $*
-    echo "$*"
-  }
-fi
+. /lib/lsb/init-functions
 
 # Enable laptop mode when the system is booted when running on battery.
 
 case $1 in
   start)
+    log_action_begin_msg "Enabling laptop mode"
     mkdir -p /var/run/laptop-mode-tools
     touch /var/run/laptop-mode-tools/enabled
-    if RESULT=`/usr/sbin/laptop_mode auto` ; then
-      log_success_msg "$RESULT"
-    else
-      log_failure_msg "$RESULT"
-    fi
+    RESULT=`/usr/sbin/laptop_mode init auto`
+    log_action_end_msg $? "$RESULT"
     ;;
 
   restart|reload|force-reload)
     # Full restart: first stop laptop mode completely (to restore default mount options etc.)
+    log_action_begin_msg "Disabling laptop mode"
     mkdir -p /var/run/laptop-mode-tools
-    rm -f /var/run/laptop-mode-tools/enabled    
-    if RESULT=`/usr/sbin/laptop_mode stop` ; then
-      log_success_msg "$RESULT"
-    else
-      log_failure_msg "$RESULT"
-    fi
+    rm -f /var/run/laptop-mode-tools/enabled
+    RESULT=`/usr/sbin/laptop_mode init stop`
+    log_action_end_msg $? "$RESULT"
 
     # Now remove files containing stored status, re-enable, and start it up again.
-    rm -f /var/run/laptop-mode-tools/*
+    log_action_begin_msg "Enabling laptop mode"
+    rm -f /var/run/laptop-mode-tools/*
     touch /var/run/laptop-mode-tools/enabled
-    if RESULT=`/usr/sbin/laptop_mode auto force` ; then
-      log_success_msg "$RESULT"
-    else
-      log_failure_msg "$RESULT"
-    fi
+    RESULT=`/usr/sbin/laptop_mode init auto force`
+    log_action_end_msg $? "$RESULT"
     ;;
 
   stop)
+    log_action_begin_msg "Disabling laptop mode"
     rm -f /var/run/laptop-mode-tools/enabled
-    if RESULT=`/usr/sbin/laptop_mode stop` ; then
-      log_success_msg "$RESULT"
-    else
-      log_failure_msg "$RESULT"
-    fi
+    RESULT=`/usr/sbin/laptop_mode init stop`
+    log_action_end_msg $? "$RESULT"
     ;;
 
   status)
--- laptop-mode-tools-1.60.orig/etc/power/scripts.d/laptop-mode
+++ laptop-mode-tools-1.60/etc/power/scripts.d/laptop-mode
@@ -28,7 +28,7 @@ if [ -w /proc/sys/vm/laptop_mode ]; then
         $LMODE "stop"
         ;;
       resume)
-        /etc/init.d/laptop-mode restart
+        $LMODE "auto" "force"
         ;;        
     esac
 elif [ -x logger ]; then	
